(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,a){e.exports=a(174)},171:function(e,t,a){},174:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(87),_=a.n(l);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=a(12),s=a(179),o=a(9),u=a(10),i=a(13),d=a(11),p=a(14),m=a(180),h=a(177),E=a(2),b=a(6),f=a(30),O=a(181),C=a(89),D=a(176),M=a(23),v=a(178),y=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(d.a)(t).call(this,e))).changeTitle=function(e){a.setState(function(e){return Object(E.a)({},e,{headerTitle:a.inputRef.current.value})})},a.changeTitleView=function(){a.setState(function(e){return Object(E.a)({},e,{showInput:!e.showInput})})},a.changeDeleteView=function(){a.setState(function(e){return Object(E.a)({},e,{showDelete:!e.showDelete})})},a.saveTitle=function(){var e=a.props,t=e.updateItem,r=e.id;r&&t({title:a.state.headerTitle},r),a.changeTitleView()},a.changeTitleKeyboard=function(e){"Enter"===e.key?a.saveTitle():a.changeTitle()},a.createNewTable=function(){var e=a.props,t=e.history,r=e.clearSheet,n=e.actionCellClear;t.push("/"),a.changeDeleteView(),r(),n()},a.deleteTable=function(){var e=a.props,t=e.id,r=e.deleteItem,n=e.history,l=e.clearSheet;r(t),n.push("/"),a.changeDeleteView(),l()},a.componentDidUpdate=function(e,t){a.props.id&&!e.id&&a.changeDeleteView()},a.state={showInput:!1,headerTitle:"",showDelete:!1},a.inputRef=n.a.createRef(),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.title,t=this.state,a=t.showInput,r=t.headerTitle,l=t.showDelete;return n.a.createElement("header",{className:"header"},n.a.createElement("div",{className:"header__logo-box",title:"Create new file"},n.a.createElement(D.a,{to:"/",onClick:this.createNewTable},n.a.createElement(v.a,{type:"file-excel",className:"header__logo"}))),n.a.createElement("div",{className:"header__name-box",onDoubleClick:this.changeTitleView},a&&n.a.createElement("input",{className:"header input",style:{display:a?"inline-block":"none"},autoFocus:!0,ref:this.inputRef,onKeyUp:this.changeTitleKeyboard,onBlur:this.saveTitle,defaultValue:e}),n.a.createElement("span",{className:"header__name",style:{display:a?"none":"inline-block"}},e||(r||"Untitled"))),n.a.createElement("div",{className:"header__delete-box",title:"Delete file"},l&&n.a.createElement(v.a,{type:"delete",onClick:this.deleteTable,className:"header__icon"})))}}]),t}(r.Component),P=Object(c.b)(function(e){return{id:e.table.id,title:e.table.title}},function(e){return Object(b.b)(Object(E.a)({},f,M),e)})(Object(O.a)(y)),S=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).componentDidMount=function(){var e=a.props,t=e.match,r=e.getSheet;t.params.id&&r(t.params.id)},a.componentDidUpdate=function(e,t){var r=a.props,n=r.match,l=r.id,_=r.error,c=r.history,s=r.clearFailRequest;if(!e.error&&_&&(c.push("/"),s()),l&&n.params.id!==l)return c.push("/".concat(l))},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"App"},n.a.createElement(P,{enableUpdate:this.enableUpdate}),n.a.createElement(C.a,null))}}]),t}(r.Component),g=Object(c.b)(function(e){return{id:e.table.id,error:e.table.error}},function(e){return Object(b.b)(Object(E.a)({},f),e)})(Object(O.a)(S)),F=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{id:"container"},n.a.createElement(m.a,null,n.a.createElement(h.a,{exact:!0,path:"/:id",component:g}),n.a.createElement(h.a,{exact:!0,path:"/",component:g}),n.a.createElement(h.a,{render:function(){return n.a.createElement("div",null,"404 NOT FOUND")}})))}}]),t}(r.Component),j=(a(171),a(98)),T=a(3),I={cell:{id:"",formula:"",cell:{},error:null},table:{id:null,title:null,table:{},error:null,isFetching:!1}},A=Object(b.c)({cell:function(e,t){return void 0===e?{id:null,formula:"",cell:{}}:"CELL_CURRENT"===t.type?{id:t.id,formula:t.formula,cell:t.cell}:"CELL_SELECTED"===t.type?{id:t.id,formula:t.formula,cell:t.cell}:"CELL_CLEAR"===t.type?{id:null,formula:"",cell:{}}:e},table:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I.table,t=arguments.length>1?arguments[1]:void 0,a=t.type,r=t.payload;switch(a){case T.h:return Object(E.a)({},e,{isFetching:!0});case T.j:var n=r.id,l=r.title,_=r.table;return Object(E.a)({},e,{id:n,title:l,table:_,isFetching:!1,error:!1});case T.i:return Object(E.a)({},e,{isFetching:!1,error:!0});case T.k:return Object(E.a)({},e,{isFetching:!0});case T.m:var c=r.id,s=r.title,o=r.table;return Object(E.a)({},e,{id:c,title:s,table:o,isFetching:!1,error:!1});case T.l:return Object(E.a)({},e,{isFetching:!1,error:!0});case T.d:return Object(E.a)({},I.table,{isFetching:!1});case T.e:return Object(E.a)({},e,{isFetching:!0});case T.g:return Object(E.a)({},I.table,{isFetching:!1,error:!1});case T.f:return Object(E.a)({},e,{isFetching:!1,error:!0});case T.c:return Object(E.a)({},e,{isFetching:!1,error:!1});default:return e}}}),U=Object(b.d)(A,I,Object(b.a)(j.a));_.a.render(n.a.createElement(c.a,{store:U},n.a.createElement(s.a,null,n.a.createElement(F,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},23:function(e,t,a){"use strict";a.r(t),a.d(t,"actionInputCell",function(){return n}),a.d(t,"actionCellClear",function(){return l});var r=a(3),n=function(e,t,a){return{type:r.b,id:e,formula:t,cell:a}},l=function(e){return{type:r.a,payload:e}}},3:function(e,t,a){"use strict";a.d(t,"h",function(){return r}),a.d(t,"j",function(){return n}),a.d(t,"i",function(){return l}),a.d(t,"k",function(){return _}),a.d(t,"m",function(){return c}),a.d(t,"l",function(){return s}),a.d(t,"d",function(){return o}),a.d(t,"e",function(){return u}),a.d(t,"g",function(){return i}),a.d(t,"f",function(){return d}),a.d(t,"c",function(){return p}),a.d(t,"b",function(){return m}),a.d(t,"a",function(){return h});var r="GET_SHEET",n="GET_SHEET_SUCCESS",l="GET_SHEET_FAIL",_="SAVE_SHEET",c="SAVE_SHEET_SUCCESS",s="SAVE_SHEET_FAIL",o="CLEAR_SHEET",u="DELETE_SHEET",i="DELETE_SHEET_SUCCESS",d="DELETE_SHEET_FAIL",p="CLEAR_FAIL",m="CELL_CURRENT",h="CELL_CLEAR"},30:function(e,t,a){"use strict";a.r(t),a.d(t,"getSheet",function(){return d}),a.d(t,"saveItem",function(){return E}),a.d(t,"updateItem",function(){return C}),a.d(t,"clearSheet",function(){return D}),a.d(t,"clearFailRequest",function(){return P}),a.d(t,"deleteItem",function(){return S});var r=a(15),n=a.n(r),l=a(35),_=a(3),c=a(36),s=a.n(c),o=function(e){return{type:_.h,payload:e}},u=function(e){return{type:_.j,payload:e}},i=function(e){return{type:_.i,payload:e}};function d(e){return function(){var t=Object(l.a)(n.a.mark(function t(a){var r,l;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(o()),t.prev=1,t.next=4,s()("http://localhost:3000/states?id=".concat(e));case 4:r=t.sent,l=r.data,a(u(l[0])),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),a(i(t.t0));case 12:case"end":return t.stop()}},t,this,[[1,9]])}));return function(e){return t.apply(this,arguments)}}()}var p=function(e){return{type:_.k,payload:e}},m=function(e){return{type:_.m,payload:e}},h=function(e){return{type:_.l,payload:e}};function E(e){return function(){var t=Object(l.a)(n.a.mark(function t(a){var r,l;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(p()),t.prev=1,t.next=4,s()("http://localhost:3000/states",{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},data:e});case 4:r=t.sent,l=r.data,a(m(l)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),a(h(t.t0));case 12:case"end":return t.stop()}},t,this,[[1,9]])}));return function(e){return t.apply(this,arguments)}}()}var b=function(e){return{type:_.k,payload:e}},f=function(e){return{type:_.m,payload:e}},O=function(e){return{type:_.l,payload:e}};function C(e,t){return function(){var a=Object(l.a)(n.a.mark(function a(r){var l,_;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r(b()),a.prev=1,a.next=4,s()("http://localhost:3000/states/".concat(t),{method:"PATCH",headers:{"Content-Type":"application/json; charset=UTF-8"},data:e});case 4:l=a.sent,_=l.data,r(f(_)),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(1),r(O(a.t0));case 12:case"end":return a.stop()}},a,this,[[1,9]])}));return function(e){return a.apply(this,arguments)}}()}var D=function(){return{type:_.d}},M=function(e){return{type:_.k,payload:e}},v=function(e){return{type:_.m,payload:e}},y=function(e){return{type:_.l,payload:e}},P=function(e){return{type:_.c,payload:e}};function S(e){return function(){var t=Object(l.a)(n.a.mark(function t(a){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(M()),t.prev=1,t.t0=a,t.t1=v,t.next=6,s()("http://localhost:3000/states/".concat(e),{method:"DELETE"});case 6:t.t2=t.sent,t.t3=(0,t.t1)(t.t2),(0,t.t0)(t.t3),t.next=14;break;case 11:t.prev=11,t.t4=t.catch(1),a(y(t.t4));case 14:case"end":return t.stop()}},t,this,[[1,11]])}));return function(e){return t.apply(this,arguments)}}()}},47:function(e,t,a){"use strict";var r=a(2),n=a(9),l=a(10),_=a(13),c=a(11),s=a(14),o=a(0),u=a.n(o),i=a(12),d=a(23),p=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(_.a)(this,Object(c.a)(t).call(this,e))).changeFormula=function(e){e.preventDefault();var t=a.props,n=t.update,l=t.cellFromState;t.isEdited?a.inputCell.current.focus():(n(l,a.inputCell.current.value),a.setState(function(e){return Object(r.a)({},e,{showInput:!e.showInput})}),a.inputCell.current.blur())},a.changeFormulaKeyboard=function(e){var t=a.props,n=t.onSend,l=t.cellFromState,_=t.enableEditing,c=t.update;n(a.defaultCell.id,a.inputCell.current.value,l),a.inputCell.current.value.toUpperCase().search(/(=\s*SUM|=\s*DIFF|=\s*PROD|=\s*DIV)\s*\(\s*/g)>=0&&_(a.defaultCell.id,!0),"Enter"===e.key?(c(l,a.inputCell.current.value),_(a.defaultCell.id,!1),a.setState(function(e){return Object(r.a)({},e,{showInput:!e.showInput})})):n(a.defaultCell.id,a.inputCell.current.value,l)},a.changeCellView=function(){a.setState(function(e){return Object(r.a)({},e,{showInput:!e.showInput})})},a.setCurrent=function(){var e=a.props,t=e.cellFromState,r=e.isEdited,n=e.actionCellClear,l=e.onSend;"cell-title"!==t.className||r?r||l(a.defaultCell.id,t.formula,t):n()},a.startSelecting=function(){a.props.startSelecting(a.defaultCell.x,a.defaultCell.y)},a.continueSelecting=function(){a.props.continueSelecting(a.defaultCell.x,a.defaultCell.y)},a.stopSelecting=function(){a.props.stopSelecting()},a.state={showInput:!1},a.defaultCell={id:a.props.cellFromState.id,x:a.props.cellFromState.x,y:a.props.cellFromState.y,formula:a.props.cell.formula},a.inputCell=u.a.createRef(),a}return Object(s.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t,a){return e.cellFromState.value!==this.props.cellFromState.value||(e.active!==this.props.active||e.isSelected!==this.props.isSelected||e.cell.id===this.props.cellFromState.id)}},{key:"componentDidUpdate",value:function(e,t){var a=this.props.selectionRange,r=this.inputCell.current;if(a&&a!==e.selectionRange){var n=e.selectionRange,l=n.start,_=n.end;if(this.state.showInput){var c=this.inputCell.current.value.toUpperCase().search(/(=\s*SUM|=\s*DIFF|=\s*PROD|=\s*DIV)\s*\(\s*/g)>=0,s=this.inputCell.current.value.toUpperCase().match(/(=\s*SUM|=\s*DIFF|=\s*PROD|=\s*DIV)/g)||"=";this.inputCell.current&&c&&l.x?l.x===_.x&&l.y===_.y?this.inputCell.current.value="".concat(s," (").concat(l.y+l.x," )"):this.inputCell.current.value="".concat(s," (").concat(l.y+l.x," : ").concat(_.y+_.x,")"):r&&"="===r.value.charAt(0)&&/(\+|\-|\:|\*)$/g.test(r.value)&&l.x&&(r.value+="".concat(l.y+l.x))}}}},{key:"render",value:function(){var e,t=this.props,a=t.isFirst,r=t.active,n=t.isSelected,l=t.cellFromState,_=this.state.showInput;return e=a?"first":r?"selected":n?"selected-formula":l.className,u.a.createElement("td",{className:"table_cell ".concat(e),onClick:this.setCurrent,onMouseDown:this.startSelecting,onMouseEnter:this.continueSelecting,onMouseUp:this.stopSelecting,onDoubleClick:this.changeCellView},_&&u.a.createElement("input",{className:"table-cell input",style:{display:_?"inline-block":"none"},autoFocus:!0,defaultValue:l.formula,ref:this.inputCell,onBlur:this.changeFormula,onKeyUp:this.changeFormulaKeyboard}),u.a.createElement("span",{style:{display:_?"none":"inline-block"}},l.value))}}],[{key:"defaultProps",get:function(){return{cell:{id:"",formula:""},cellFromState:{value:"",id:"",className:"cell"},onSend:function(e,t){console.log("onSend isn't set",e,t)},startSelecting:function(e){return null},continueSelecting:function(e){return null},stopSelecting:function(e){return null}}}}]),t}(o.Component);t.a=Object(i.b)(function(e){return{cell:e.cell}},{onSend:d.actionInputCell,actionCellClear:d.actionCellClear})(p)},89:function(module,__webpack_exports__,__webpack_require__){"use strict";var D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(24),D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9),D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10),D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(13),D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(11),D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_7__),react_redux__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(12),redux__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(6),_actions_table__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(30),react_router_dom__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(181),_Controlscontainer__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(90),_components_Cell__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(47),MathTable=function(_Component){function MathTable(props){var _this;return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__.a)(this,MathTable),_this=Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__.a)(this,Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__.a)(MathTable).call(this,props)),_this.componentDidUpdate=function(e,t){var a=_this.props,r=a.table,n=a.id,l=a.saveItem,_=a.updateItem;r&&r!==e.table&&_this.setState(function(e){return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},e,{table:r,counter:2})}),0==t.counter&&1==_this.state.counter&&t.table!==_this.state.table?(l({title:"Untitled",table:Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},_this.state.table)}),_this.props.history.push("/".concat(n))):_this.state.counter>0&&_this.state.counter<10&&t.table!==_this.state.table?console.log("pass update",_this.state.table):10===_this.state.counter&&t.counter!==_this.state.counter&&_({table:_this.state.table},n)},_this.enableEditing=function(e,t){var a={selectedCells:[],pressed:!1,startX:null,startY:null,endX:null,endY:null};_this.setState(function(r){return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},r,{selectionInFormula:a,currentCell:{id:e,isEdited:t}})})},_this.startSelecting=function(e,t){var a=_this.state.currentCell.isEdited,r={selectedCells:[t+e],pressed:!0,startX:e,startY:t,endX:e,endY:t};t+e!==_this.state.currentCell.id&&_this.setState(function(e){return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},e,{selection:a?Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},e.selection):r,selectionInFormula:a?r:Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},e.selectionInFormula),currentCell:Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},e.currentCell)})})},_this.continueSelecting=function(e,t){var a=_this.state.currentCell.isEdited?"selectionInFormula":"selection";if(_this.state[a].pressed&&_this.state[a].startY+_this.state[a].startX!==_this.state.currentCell.id){var r=_this.getSelectedCells(_this.state[a].startX,_this.state[a].startY,e,t);_this.setState(function(n){return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},n,Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)({},a,{selectedCells:r,pressed:!0,startX:n[a].startX,startY:n[a].startY,endX:e,endY:t}))})}},_this.getSelectedCells=function(e,t,a,r){var n=[],l=_this.range;return l(t.charCodeAt(0),r.charCodeAt(0)).map(function(t){l(+e,+a).map(function(e){var a=String.fromCharCode(t);n.push(a+e)})}),n},_this.range=function(e,t){for(var a=[],r=t-e>0,n=e;r?n<=t:n>=t;r?n++:n--)r?a.push(n):a.unshift(n);return a},_this.stopSelecting=function(){_this.setState(function(e){return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},e,{selection:Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},e.selection,{pressed:!1}),selectionInFormula:Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},e.selectionInFormula,{pressed:!1}),currentCell:Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},e.currentCell,{id:null})})})},_this.calculateValue=function(state,formula,id){var _value=null,operation=null,rangeMatch=null,stringCell={formula:formula,value:formula,className:"cell left"};if("'"===formula.charAt(0))return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},stringCell,{value:formula.substring(1)});if('"'===formula.charAt(0)||"`"===formula.charAt(0))return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},stringCell);if("="===formula.charAt(0))try{if(1===formula.length)throw"error";formula=formula.toUpperCase();var updatedFormula=formula;if(formula.indexOf(id)>=0)throw"error";var divNull=formula.search(/\/(?=0)+/g);if(divNull>0)return{formula:formula,value:"#DIV/0!",className:"cell-error"};var notProperSymbols=formula.search(/[^*\/+=() :\-0-9A-Z]+/g);if(notProperSymbols>0)return{formula:formula,value:"#NAME?",className:"cell-error"};if(rangeMatch=formula.search(/^(=\s*SUM|=\s*DIFF|=\s*PROD|=\s*DIV)\s*\(\s*[A-Z][0-9]+\s*:\s*[A-Z][0-9]+\s*\)/g)>=0,rangeMatch){var start=formula.match(/[A-Z][0-9]/g)[0],end=formula.match(/[A-Z][0-9]/g)[1]||start,startX=start.slice(1),endX=end.slice(1),arrFromState=_this.getSelectedCells(startX,start[0],endX,end[0]);if(arrFromState.indexOf(id)>=0)throw"error";var arrOfValues=[];switch(arrFromState.forEach(function(e){var t=e.slice(1),a=state[e[0]]&&state[e[0]][t]&&state[e[0]][t].value?+state[e[0]][t].value:0;arrOfValues.push(a)}),operation=formula.match(/(\s*SUM|\s*DIFF|\s*PROD|\s*DIV)/g)[0].trim().toLowerCase(),operation){case"sum":_value=arrOfValues.reduce(function(e,t){return e+t});break;case"diff":_value=arrOfValues.reduce(function(e,t){return e-t});break;case"prod":_value=arrOfValues.reduce(function(e,t){return e*t});break;case"div":_value=arrOfValues.reduce(function(e,t){return e/t});break;default:_value=eval(updatedFormula.substring(1))}return{formula:formula,value:_value,className:"cell"}}var matches=formula.match(/[A-Z][1-9]+/g)||[];return matches.length?(matches.forEach(function(e){var t=e.slice(1),a=state[e[0]]&&state[e[0]][t]&&state[e[0]][t].value?state[e[0]][t].value:"0";updatedFormula=updatedFormula.replace(e,a)}),_value=eval(updatedFormula.substring(1)),{formula:formula,value:_value,className:"cell"}):(_value=eval(formula.substring(1)),{formula:formula,value:_value,className:"cell"})}catch(e){return{formula:formula,value:"error",className:"cell-error"}}else{if("="!==formula.charAt(0)&&formula.search(/\D/g)>=0)return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},stringCell);if("="!==formula.charAt(0))return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},stringCell,{className:"cell"})}},_this.cellUpdate=function(e,t,a){var r=""+t.id,n=Object.assign({},t,_this.calculateValue(e,a,r)),l=r.slice(1);for(var _ in void 0===e[r[0]]&&(e[r[0]]={}),e[r[0]][l]=n,e)for(var c in e[_]){var s=e[_][c],o=s.formula.search(/^(=\s*SUM|=\s*DIFF|=\s*PROD|=\s*DIV)\s*\(\s*[A-Z][0-9]+\s*:\s*[A-Z][0-9]+\s*\)/g)>=0;if("="===s.formula.charAt(0)&&s.formula.indexOf(t.id)>-1&&s.id!==t.id)e=_this.cellUpdate(e,s,s.formula);else if(s.id!==t.id&&o){var u=s.formula.match(/[A-Z][0-9]/g)[0],i=s.formula.match(/[A-Z][0-9]/g)[1]||u,d=u.slice(1),p=i.slice(1);_this.getSelectedCells(d,u[0],p,i[0]).indexOf(r)>=0&&(e=_this.cellUpdate(e,s,s.formula))}}return e},_this.updateState=function(e,t){if(t){var a=JSON.parse(JSON.stringify(_this.state.table)),r=""+t,n=_this.cellUpdate(a,e,r);n!==_this.state.table&&_this.setState(function(e){return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},e,{table:n,counter:10===e.counter?1:e.counter+1})})}},_this.cellTable=function(e,t,a,r){for(var n=[],l=a;l<=r;l++){for(var _=[],c=e.charCodeAt(0);c<=t.charCodeAt(0);c++){var s={};Object.assign(s,{x:l,y:String.fromCharCode(c)}),_.push(s)}n.push(_)}return n},_this.state={table:{},selection:{selectedCells:[],pressed:!1,startX:null,startY:null,endX:null,endY:null},selectionInFormula:{selectedCells:[],pressed:!1,startX:null,startY:null,endX:null,endY:null},currentCell:{id:null,isEdited:!1},counter:0},_this}return Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__.a)(MathTable,_Component),Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_3__.a)(MathTable,[{key:"render",value:function(){var e=this,t=this.state,a=t.selection,r=t.currentCell,n=t.selectionInFormula,l=t.counter,_="";0===l?_="Unsaved":l>0&&l<10?_="Changed":10===l&&(_="Saved");var c={start:{x:n.startX,y:n.startY},end:{x:n.endX,y:n.endY}},s=this.cellTable("@","Z",0,40).map(function(t,l){return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("tr",{key:l,className:0===l?"row-first":"row"},t.map(function(t){var l,s=t.x,o=t.y,u=o+s,i={id:o+s,x:s,y:o,value:null,formula:null,className:"cell-title"};return 0==s?react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_components_Cell__WEBPACK_IMPORTED_MODULE_13__.a,{key:u,cellFromState:Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},i,{value:"@"==o?_:o,className:"cell-title"}),isEdited:r.isEdited}):"@"==o?react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_components_Cell__WEBPACK_IMPORTED_MODULE_13__.a,{key:u,cellFromState:Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},i,{value:s,className:"cell-title"}),isEdited:r.isEdited}):react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_components_Cell__WEBPACK_IMPORTED_MODULE_13__.a,(l={key:u,update:e.updateState,enableEditing:e.enableEditing,isSelected:a.selectedCells.pressed,isEdited:r.isEdited,startSelecting:e.startSelecting,continueSelecting:e.continueSelecting,stopSelecting:e.stopSelecting,isFirst:a.startX&&a.startY+a.startX===u,active:!r.isEdited&&a.selectedCells.some(function(e){return e==u})},Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(l,"isSelected",r.isEdited&&n.selectedCells.some(function(e){return e==u})),Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(l,"selectionRange",c),Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(l,"cellFromState",void 0!==e.state.table[o]&&void 0!==e.state.table[o][s]?e.state.table[o][s]:Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},i,{value:"",formula:"",className:"cell"})),l))}))});return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("div",{className:"wrapper"},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_Controlscontainer__WEBPACK_IMPORTED_MODULE_12__.a,{update:this.updateState,enableArray:r.isEdited,selectionRange:c,enableEditing:this.enableEditing}),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("div",{className:"table-box"},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("table",{className:"table"},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("tbody",null,s))))}}]),MathTable}(react__WEBPACK_IMPORTED_MODULE_7__.Component),mapStateToProps=function(e){return{id:e.table.id,table:e.table.table}},mapDispatchToProps=function(e){return Object(redux__WEBPACK_IMPORTED_MODULE_9__.b)(Object(D_MyFrontEnd_react_exel_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__.a)({},_actions_table__WEBPACK_IMPORTED_MODULE_10__),e)};__webpack_exports__.a=Object(react_redux__WEBPACK_IMPORTED_MODULE_8__.b)(mapStateToProps,mapDispatchToProps)(Object(react_router_dom__WEBPACK_IMPORTED_MODULE_11__.a)(MathTable))},90:function(e,t,a){"use strict";var r=a(2),n=a(9),l=a(10),_=a(13),c=a(11),s=a(14),o=a(0),u=a.n(o),i=a(12),d=a(6),p=a(23),m=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(_.a)(this,Object(c.a)(t).call(this,e))).changeCellFormulaKeyboard=function(e){var t=a.props,r=t.update,n=t.actionInputCell,l=t.enableEditing,_=t.cell;a.inputCell.current.value.toUpperCase().search(/(=\s*SUM|=\s*DIFF|=\s*PROD|=\s*DIV)\s*\(\s*/g)>=0&&l(_.id,!0),"Enter"===e.key?(a.inputCell.current.value!==_.cell.formula&&r(_.cell,a.inputCell.current.value),l(_.id,!1),a.setState({enableAutoFocus:!1}),a.inputCell.current.blur()):(n(_.id,a.inputCell.current.value,_.cell),a.setState({enableAutoFocus:!0}),a.inputCell.current.focus())},a.updateState=function(e){e.preventDefault();var t=a.props,r=t.update,n=t.cell;a.state.enableAutoFocus&&(a.inputCell.current.value!==n.cell.formula?(r(a.props.cell.cell,a.inputCell.current.value),a.inputCell.current.blur(),a.setState({enableAutoFocus:!1})):(a.inputCell.current.focus(),a.setState({enableAutoFocus:!1})))},a.state={enableAutoFocus:!1},a.inputCell=u.a.createRef(),a}return Object(s.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t,a){return e.cell.id,this.props.cell.id,!0}},{key:"componentDidUpdate",value:function(e,t){var a=this.props.selectionRange,r=a.start,n=a.end;if(this.props.enableArray){var l=this.inputCell.current.value.toUpperCase().search(/(=\s*SUM|=\s*DIFF|=\s*PROD|=\s*DIV)\s*\(\s*/g)>=0,_=this.inputCell.current.value.toUpperCase().match(/(=\s*SUM|=\s*DIFF|=\s*PROD|=\s*DIV)/g)||"=";this.inputCell.current&&l&&r.x&&(r.x===n.x&&r.y===n.y?this.inputCell.current.value="".concat(_," (").concat(r.y+r.x," )"):this.inputCell.current.value="".concat(_," (").concat(r.y+r.x," : ").concat(n.y+n.x,")"))}}},{key:"render",value:function(){return u.a.createElement("div",{className:"controls",key:this.props.cell.formula},u.a.createElement("span",{name:"id",className:"controls_current-id"},this.props.cell.id?this.props.cell.id:"ID"),u.a.createElement("input",{className:"controls_input",name:"formula",type:"text",autoFocus:this.state.enableAutoFocus,disabled:!this.props.cell.id,defaultValue:this.props.cell.formula,ref:this.inputCell,onKeyUp:this.changeCellFormulaKeyboard,onBlur:this.updateState}))}}],[{key:"defaultProps",get:function(){return{cell:{id:"",formula:"",cell:{}},actionInputCell:function(e,t){console.log("actionInputCell isn't set",e,t)}}}}]),t}(o.Component);t.a=Object(i.b)(function(e){return{cell:e.cell}},function(e){return Object(d.b)(Object(r.a)({},p),e)})(m)}},[[100,2,1]]]);
//# sourceMappingURL=main.fdf63d46.chunk.js.map